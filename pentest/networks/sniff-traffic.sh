# capture network traffic on a specific iface
tshark -i wlan0 -w traffic.cap

# same with tcpdump
tcpdump -i wlan0 -w wifi.pcap

# useful options
tcpdump -r foo.pcap -XX # display packets in HEX & ASCII
tcpdump -r foo.pcap -nn # do not resolve MAC / IPs
tcpdump -r foo.pcap -s 0 # same as '-s 65535': do NOT truncate packets
tcpdump -r foo.pcap 'port 53' # display only traffic on port 53 (ie DNS)
tcpdump -r foo.pcap -A # interpret packet content as ASCII
tcpdump -r foo.pcap 'host 1.2.3.4' # only traffic involving the given IP

# wpa handshakes
# -U write to disk right away
# -I monitor mode
# -c 4 exit after wapturing 4 packets
sudo tcpdump -i wlan0 -I -w test.cap -e -U -c 4 \
  'ether proto 0x888e and (wlan addr1 11:22:33:44:55:66 or wlan addr1 66:55:44:33:22:11)'
