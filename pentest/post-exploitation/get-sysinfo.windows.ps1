Param (
    $ComputerName = "LabVM",
    $NumItems = 10,
    $ReportFile = "C:\Class\Top10Mem.txt")

if([string]::IsNullOrEmpty($ReportFile)) {
    Get-Process -ComputerName $ComputerName | Sort-Object -Descending -Property WS | Select-Object -First $NumItems
} else {
    Get-Process -ComputerName $ComputerName | Sort-Object -Descending -Property WS | Select-Object -First $NumItems > $ReportFile
}

&{
  Write-Output "OS ============================================================"
  Get-CimInstance Win32_OperatingSystem

  Write-Output "BIOS =========================================================="
  Get-CimInstance Win32_BIOS

  Write-Output "Computer Info ================================================="
  Get-CimInstance Win32_ComputerSystem

  Write-Output "Firewall ======================================================"
  Get-Service -DisplayName *firewall*

  Write-Output "Firewall Rules ================================================"
  Get-NetFirewallProfile

  Write-Output "Services ======================================================"
  Get-Service

  Write-Output "Software ======================================================"
  Get-WmiObject Win32_Product

  Write-Output "Features ======================================================"
  Get-WindowsFeature
} > C:\ServerInfo.txt

&{
  Write-Output "Administrators Info============================================"
  Get-LocalGroupMember -Group "Administrators"

  Write-Output "User Info ====================================================="
  Get-CimInstance Win32_OperatingSystem | Select-Object -Property *user*
} > C:\AccountInfo.txt

&{
  Write-Output "Network Information ==========================================="
  Get-NetAdapter
  Get-NetAdapterAdvancedProperty
  Get-NetIPConfiguration

  Write-Output "Connectivity =================================================="
  Test-Connection -ComputerName Server1
  Test-Connection 192.168.1.1
  Test-NetConnection 192.168.1.1
  Test-NetConnection -CommonTCPPort http
} > C:\NetworkInfo.txt
